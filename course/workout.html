<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>AngularJs Workout</title>

		<meta name="description" content="Advanced AngularJs training">
		<meta name="author" content="Tamas Hoffman">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">
		<link rel="stylesheet" href="css/main.css">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.min.js"></script>


		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body class="workout">

		<div class="reveal">
      <div class="slides">
				<section>
					<img id="angularLogo"src="img/angularJs.png">
					<h1>AngularJs</h1>
					<h3>Best practices</h3>
					<p>
						<small>Created by <a href="https://github.com/silverHub/AngularJsTraining">Tamas Hoffman</a></small>
					</p>
				</section>
				<section>
					<section>
					<h2>Agenda</h2>
					<ul class="fontSize80">
						<li>Application bootstrap process</li>
            <ul>
              <li>Bootstrapping</li>
							<li>App config and run block</li>
							<li>Digest cycle</li>
							<ul>
									<li>Something happens out of the Angular context</li>
							</ul>
							<li>Manual bootstrapping</li>
              <li>Services related to bootstrap</li>
            </ul>
						<li>Best practices</li>
            <ul>
							<li>Misc: style guide, UI bootstrap, Ionic frameworks, Batarang</li>
							<li>How to architect your app</li>
							<li>Nesting</li>
							<li>Custom directives</li>
              <li>Communication through events</li>
              <li>Handle 3rd party components</li>
							<li>Performance</li>
							<ul>
								<li>One time binding</li>
								<li>Filter in ctrl</li>
								<li>ngRepeat with index</li>
								<li>configure to skip DOM node annotation</li>
							</ul>
						</ul>
            <li>Resources</li>
					</ul>
					</section>
				</section>
				<section>
					<section>
						<h1>Angular application anatomy</h1>
						<h6>All in one place</h6>
					</section>
          <section>
            <img class="width80" src="img/webapp.jpg" />
            <aside class="notes">
              Let's just have a short recap about the angular application structure.
							In Angular the highest level containers are the modules. As we already know there is dedicated module
							which loads first that one is called the root module, every other module should be referenced from there or
							from any subsequent modules. Every module has a config section, I'll talk about that later.
							In a nutshell if you are employing router, than in this config section you should define your routes
							which are basically the controller+template for a specific url. With the help of the routes you can easily split your
							application to pages. If we go further down the hierarchy then ctrls can employ factories to outsource the business logic
							and wiews can contain directives.
            </aside>
          </section>
					<section class="iframe">
						<!-- Sample app for router -->
						<iframe src="https://embed.plnkr.co/VWUIHAf17PXQsgGX6u0T/" frameborder="0"></iframe>
						  <aside class="notes">
								This application is works fine, but we don't really understand yet entirely how. So let's dig deeper.
							</aside>
          </section>
				</section>
				<section>
					<section>
						<h1>Bootstrap process</h1>
						<h6>Let's start</h6>
					</section>
					<section>
            <img src="img/bootstrap.jpg">
            <aside class="notes">
							Let's start with the application bootstrapping process, the question is what is really happening when angular.js is loaded into our page.
              Let's follow the happenings from the point when DOMContentLoaded event is fired in the browser, Angular has a listener to that event which kicks the whole framework in motion.
              First of all Angular traverse through the DOM to find the ng-app directive, which marks the root element of our app.
              Then Angular loads the module defined in ng-app and creates the injector service which will be used for the DI.
              First the injector creates the $rootScope object which will be the default context of our application.
              As a last step, Angular goes through the DOM tree starting from the root element, setting up the bindings and compiles directives.
              After that our application is running and waiting for the first event to come.
            </aside>
					</section>
					<section class="iframe">
						<iframe src="https://embed.plnkr.co/w4bOYWDWYOi9xjQTr2jt/" frameborder="0"></iframe>
						<aside class="notes">
							Here you can see the execution order of the different building blocks.
							Some key points:
								- only those controllers are instantiated which represented on the page
								- factories/services are singleton, dependency injection is lazy, instances created when used
						</aside>
					</section>
					<section>
						<ul>
							<li>Module <strong>config block</strong></li>
							<ul>
								<li>Place to preconfigure your services</li>
								<li>You can inject providers and constants only</li>
								<li>Providers are special services which provides configuration options before instance creation</li>
								<li>e.g. $route -> $routeProvider</li>
							</ul>
							<li>Module <strong>run block</strong></li>
							<ul>
								<li>Place to execute arbitrary code</li>
								<li>Executed when all module is loaded</li>
							</ul>
						</ul>
						<aside class="notes">
							You can use these special blocks to preconfigure your services or execute some arbitratry code.
							Both parameter is a function which will be run before the service instances created.
							Very important that the injection type is limited.
						</aside>
					</section>
          <section>
						<p>
							<strong>Question:</strong> what happens if you have no ng-app on the page?
						</p>
						<p class="fragment">
							<strong>Question2:</strong> what happens if you have multiple ng-app on the page?
						</p>
						<p class="fragment">
							There is a way to manually bootstrap independent modules:
						</p>
						<p><pre><code>angular.bootstrap(angular.element('#container'), ['Main']);</code></pre></p>
						=
						<p><pre class="html"><code><div id="container" ng-app="Main"><!-- Content --></div></code></pre></p>
						<aside class="notes">
							A1: Nothings. The bootstrap process is not started, the views are not generated.
							A2: First HTML tag with ng-app will be the root element, others will be ignored.
							There is a way to manually bootstrap independent modules.
						</aside>
					</section>
          <section class="iframe">
              <ul>
								Why do we need manual bootstrapping?
								<li class="fragment">to run multiple distinct module on the same page</li>
              	<li class="fragment">to delay the boot process</li>
              </ul>
							<iframe class="fragment" src="http://embed.plnkr.co/qCxFXH2cZAtda6ZMn8eZ/" frameborder="0"></iframe>
							<!-- Sample app for manual bootstrapping -->
							<aside class="notes">
								Do we really need it? The thing is, this comes really handy in certain situations:
								Think about an aggregator page where you would like to delegate only one of your module as everybody else. We have such a scenario.
								Maybe a dozen different module aggregated on that page, rendering only parts of it.
								It's possible that those modules coming from entirely different sources, in this case how can you pick a root module?
								You cannot pick one because the others won't be dependencies.
								So in this case you should initiate manually the bootprocess for every separate module.
								There are also situations where you would like to do some DOM manipulation or server enquiry before application boot.
								These are the typical use cases of manual bootstrapping.
								Let's see an example code.
							</aside>
          </section>

				</section>
				<section>
					<section>
						<h1>Digest cycle</h1>
						<h6>Keeps everyting in motion</h6>
						<aside class="notes">
							Now that we are familiar with the boot process, let's talk about how your application achieve to react to your interactions.
							The process behind this called digest cycle.
							.which is the process behind Angular 2-way data binding.
							The main question here how does Angular know about data changes.
							Actually Angular uses a very simple trick, it registers a watcher every time you create a binding. this watcher
							If you interact with an Angular application it will respond to your actions,
						</aside>
					</section>
					<section>
						<ul>
							<li>loop running after every interaction (in Angular context!) </li>
							<li>compare scope variable new and old values (dirty checking)</li>
							<li>if it finds any difference updates DOM</li>
						</ul>
						<img src="img/digest_cycle.png" alt="" />
						<aside class="notes">
							The power behind 2way data-binding
						</aside>
					</section>
					<section>
						<ul>
							<li>maintains a watchlist per scope</li>
							<li>the followings are creating a watcher (entry in the watchlist)</li>
						</ul>
						<p><pre><code><input ng-model="username"/> <!--ng-model creates a watcher-->
username: {{username}} <!--bindings create watcher--></code></pre></p>
							<p><pre><code>$scope.$watch('username', validate); //create watcher in ctrl

function validate(oldVal, newWal){
	console.log(oldVal,newVal);
}</code></pre></p>
					<ul>
						<li>watchers can modify other scope variables -> creates a ripple effect -> application slowes down</li>
						<li>digest can run maximum 10 times than angular throws error</li>
					</ul>
					<aside class="notes">

					</aside>
					</section>
					<section class="iframe">
						<iframe src="https://embed.plnkr.co/XaiQcYNEiaGcOksA9QJy/" frameborder="0"></iframe>
					</section>
					<section>
						$apply and $digest
						<ul>
							<li>methods on every $scope object</li>
							<li>$digest: starts digest loop</li>
							<li>$apply: waits a fn as param, and calls $digest after fn executed</li>
						</ul>
					</section>
					<section>
						Best practices
						<ul>
							<li>the execution time of the digest loops affect application performance</li>
							<li>try to keep watchers under 2000 per page</li>
							<li>use simple objects on $scope to makes comparing fast</li>
							<li>use Batarang or ng-stat to keep track of digest cycles</li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						Best practices - Architecture
					</section>
				</section>
				<section>
					<section>
						Best practices - Performance
					</section>
				</section>
				<section class="resources" >
					<h2>Resources</h2>
					<ul >
            <li><a href="http://silverhub.github.io/AngularJsTraining">Presentation slides</a></li>
						<li><a target="_blank" href="https://angularjs.org/">AngularJs doc</a></li>
						<li><a target="_blank" href="https://github.com/johnpapa/angular-styleguide/tree/master/a1">AngularJs style guide</a></li>
					</ul>
				</section>
				<section data-background="img/question.jpg">
					<h2 class="whiteTransparentBackground">Questions?</h2>
				</section>
				<section>
					<h2>Thanks for your attention!</h2>
					<h4>(Feedbacks appreciated!)</h4>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				transition: 'convex', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>
	</body>
</html>
